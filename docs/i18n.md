# I18N

## 多语言框架

本项目使用硬编码本地语言，且使用 `next-intl` 作为国际化框架，使用 `with routing`模式。  
意味着需要使用 Nextjs 的 `middleware`，必须开启 Nextjs 服务端能力，
无法在`next.config.ts`中配置`output: export`。
从这一点就不能无缝移植到`tauri`作为前端，如果有 desktop 需求，可以暂时考虑 `electron`。


## 多语言使用

`/src/i18n/routing.ts` 作为语言配置文件，其中`locales`和`defaultLocale`为可能需要编辑字段。
本项目使用`zh-CN`作为默认语言。

`/messages/@target` 目录是框架实际使用的语言目录，但本目录由脚本自动生成，不需要也禁止手动编辑。  
/messages下的其他语言目录作为开发编辑内容。当需要修改或新增**已存在**语言的内容，在此目录内编辑。  
每次语言有变动，需执行 `script:locale` 的 *npm script*来生成*@target*。  
语言生成脚本会有检查和警告机制，注意查看，特别是语言过多的。

*语言文件规则:*
1. 每个语言文件为一个**json**文件，且只能有**一个一级字段**
2. **一级字段**名必须与文件名一致，且大小写敏感
3. 需以默认语言为准，保证所有语言拥有相同的结构和文件
4. 当非默认语言缺失默认语言拥有的字段，生成脚本会以默认语言作为fallback，且脚本会警告

> [!IMPORTANT]
> 本项目使用`zh-CN`作为默认语言，如需更换，先修改 `/src/i18n/routing.ts` 内的  
> `defaultLocale`字段，并将该语言置为`locales`字段的第一个元素。  
> 再编辑`next.config.ts`中`next-intl/plugin`插件的`createMessagesDeclaration`  
> 以默认语言为准生成ts类型

## 新增语言

在 `/messages` 目录下新建语言文件夹，建议`<语言>-<地区>`形式以更细致区分语言。  
如果需要使用`antd`，则还需要在*antd*的专属*Provider*中新增`dayjs`与antd自身的语言配置。  
antd的provider配置见 /docs/antd.md。

------
